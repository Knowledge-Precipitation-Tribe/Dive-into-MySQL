# 日期和时间处理函数

日期和时间采用相应的数据类型和特殊的格式存储，以便能快速和有效地排序或过滤，并且节省物理存储空间。

一般，应用程序不使用用来存储日期和时间的格式，因此日期和时间函数总是被用来读取、统计和处理这些值。由于这个原因，日期和时间函数在MySQL语言中具有重要的作用。

## 常用日期和时间处理函数

![](../../.gitbook/assets/image%20%287%29.png)

这是重新复习用WHERE进行数据过滤的一个好时机。迄今为止，我们都是用比较数值和文本的WHERE子句过滤数据，但数据经常需要用日期进行过滤。 用日期进行过滤需要注意一些别的问题和使用特殊的MySQL函数。

首先需要注意的是MySQL使用的日期格式。无论你什么时候指定一个日期，不管是插入或更新表值还是用WHERE子句进行过滤，日期必须为格式yyyy-mm-dd。因此，2005年9月1日，给出为2005-09-01。虽然其他的日期格式可能也行，但这是首选的日期格式，因为它排除了多义性（如， 04/05/06是2006年5月4日或2006年4月5日或2004年5月6日或……）。

```text
SELECT cust_id, order_num
FROM orders
WHERE order_date = '2005-09-01';
```

![](../../.gitbook/assets/image%20%2816%29.png)

但是， 使用 WHERE order_date = '2005-09-01'可靠吗？ order_ date的数据类型为 datetime。这种类型存储日期及时间值。样例表中的值全都具有时间值00:00:00， 但实际中很可能并不总是这样。 如果用当前日期和时间存储订单日期（因此你不仅知道订单日期， 还知道下订单当天的时间 ），怎么办 ？比如 ，存储的order\_date 值为 2005-09-01 11:30:05， 则 WHERE order\_date = '2005-09-01'失败。 即使给出具有该日期的一行，也不会把它检索出来，因为 WHERE匹配失败。

解决办法是指示MySQL仅将给出的日期与列中的日期部分进行比较，而不是将给出的日期与整个列值进行比较。为此，必须使用Date\(\)函数。 Date\(order\_date\) 指示MySQL仅提取列的日期部分，更可靠的 SELECT语句为：

```text
SELECT cust_id, order_num
FROM orders
WHERE Date(order_date) = '2005-09-01';
```

{% hint style="info" %}
如果要的是日期，请使用Date\(\)如果你想要的仅是日期，则使用Date\(\)是一个良好的习惯，即使你知道相应的列只包含日期也是如此。这样，如果由于某种原因表中以后有日期和时间值，你的SQL代码也不用改变。当然，也存在一个Time\(\)函数，在你只想要时间时应该使用它。
{% endhint %}

不过，还有一种日期比较需要说明。如果你想检索出2005年9月下的 所有订单，怎么办？简单的相等测试不行，因为它也要匹配月份中的天数。有几种解决办法，其中之一如下所示：

```text
SELECT cust_id, order_num
FROM orders
WHERE Date(order_date) BETWEEN '2005=09-01' AND '2005-09-30';
```

![](../../.gitbook/assets/image%20%28117%29.png)

还有另外一种办法（一种不需要记住每个月中有多少天或不需要操心闰年2月的办法）：

```text
SELECT cust_id, order_num
FROM orders
WHERE Year(order_date) = 2005 AND Month(order_date) = 9;
```

